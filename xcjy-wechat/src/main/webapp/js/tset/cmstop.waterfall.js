(function(){var d,k=!0,b=[],c,n,l,m=!1,f=1,p=function(a){for(var h,g,e=0,c=a.length;e<c;e++){h=0;g=b[0];for(var i=1,f=b.length;i<f;i++)b[i]<g&&(h=i,g=b[i]);g=b[h];a[e].style.left=155*h+"px";a[e].style.top=g+"px";b[h]=g+0+a[e].offsetHeight;a[e].className="ui-cell ui-ready"}d.css("height",Math.max.apply(Math,b));k=!0;j()},q=function(){c=Math.floor((l.width()+5)/155);if(b.length!=c){b=[];d.css("width",155*c-5);for(var a=0;a<c;a++)b.push(0);p(d[0].childNodes)}else j()},j=function(){if(k&&(window.innerHeight||
document.documentElement.clientHeight)+(document.documentElement.scrollTop||document.body.scrollTop)>Math.min.apply(Math,b)){k=!1;var a=!0;m||(m=!0,$.post("default.htm",{width:150,page:f,pagesize:10},function(b){if(b&&b.data&&b.data.length){var c=document.createDocumentFragment(),e=[];$.each(b.data,function(b,a){var d=$('<div class="ui-cell">').html('<a href="'+a.url+'"><img src="'+a.src+'" height="'+a.height+'" /><h3 class="ui-picture-title">'+a.title+"</h3></a>");e.push(d[0]);c.appendChild(d[0])});
d.append(c);p(e);a=10*f<(parseInt(b.total)||0);f+=1}else a=!1;a||($("#loader").hide(),$(window).off("scroll"));m=!1},"json"))}};$(function(){d=$(".js-waterfall");l=$(".ui-container");c=Math.floor((l.width()+5)/155);$(window).on("scroll",function(){j()}).on("resize",function(){clearTimeout(n);n=setTimeout(q,500)});d.css("width",155*c-5);for(var a=0;a<c;a++)b.push(0);j()})})();
